const socket = io(), msgButton = document.querySelector("#msgBtn"), msgForm = document.querySelector(".msgForm"), msgInput = document.querySelector("#messageInput"), messages = document.querySelector(".main-messages"), userList = document.querySelector(".users"), msgTemp = document.querySelector("#msgTemp").innerHTML; if (null === localStorage.getItem("name")) alert("No user logged in. Please login to use ChatApp"), window.location = "/"; else { function handleMessageForm(e) { e.preventDefault(), msgButton.setAttribute("disabled", "disbaled"); const t = msgInput.value; if (t.length < 1) return alert("No blank messages!"); const o = { text: t, sender: localStorage.getItem("name") }; socket.emit("NEW_MSG", o, () => { console.log("The message was delivered!"), msgButton.removeAttribute("disabled") }), msgInput.value = "", msgInput.focus() } function logout() { var e = localStorage.getItem("name"); localStorage.removeItem("name"), axios.post("/logout", { name: e }).then(e => { let t = e.data.users; socket.emit("UPDATE_USERS", t), alert(e.data.info) }).catch(e => { console.log(e) }), window.location = "/" } socket.on("GREET_MSG", e => { console.log(e) }), socket.on("MESSAGE", e => { const t = Mustache.render(msgTemp, { msg: e }); messages.insertAdjacentHTML("beforeend", t) }) }